pub(crate) mod detour;
pub(crate) mod hooks;
pub(crate) mod map;

#[repr(C)]
#[derive(Copy, Clone, Eq, PartialEq)]
pub struct HxLoaderParameterBlock {
    pub base_address: u64,
    pub pe_size: u64,
    pub booted_from_hxloader: bool,
}

// mov rax, <addr>
// push rax
// ret
pub const HOOK_BYTES: [u8; 12] = [
    0x48, 0xB8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x50,
    0xC3,
];

// mov rax, <addr>
// mov r8, 1
// sub rsp, 0x8 - DONE FOR STACK ALIGNMENT!
// push rcx
// push rdx
// call rax
// pop rdx
// pop rcx
pub const BASIC_CALL: [u8; 27] = [
    0x48, 0xB8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x49, 0xC7, 0xC0, 0x01, 0x00, 0x00, 0x00,
    0x48, 0x83, 0xEC, 0x8,
    0x51,
    0x52,
    0xFF, 0xD0,
    0x5A,
    0x59,
];

// add rsp, 8
// ret
pub const BASIC_CALL_PROLOGUE: [u8; 5] = [
    0x48, 0x83, 0xC4, 0x8,
    0xC3
];
